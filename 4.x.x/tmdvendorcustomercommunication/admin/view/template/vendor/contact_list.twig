{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="float-end">
        <button type="button" data-bs-toggle="tooltip" title="{{ button_delete }}" class="btn btn-danger" onclick="confirm('{{ text_confirm }}') ? $('#form-review').submit() : false;"><i class="fa-solid fa-trash"></i></button>
      </div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
        <li class="breadcrumb-item"><a href="{{ breadcrumb.href }}">{{ breadcrumb.text }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if error_warning %}
    <div class="alert alert-danger alert-dismissible"><i class="fa-solid fa-exclamation-circle"></i> {{ error_warning }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% endif %}
    {% if success %}
    <div class="alert alert-success alert-dismissible"><i class="fa-solid fa-check-circle"></i> {{ success }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    {% endif %}
    <div class="card">
      <div class="card-header"><i class="fa-solid fa-list"></i> {{ text_list }}</div>
      <div class="card-body">
        <div class="card mb-3">
          <div class="card-body">
            <div class="row">
              <div class="col-sm-3">
                <div class="mb-3">
                  <label class="form-label">{{ column_name }}</label>
                  <input type="text" name="filter_enqname" value="{{ filter_enqname }}" placeholder="{{ column_name }}" id="input-filter_enqname" class="form-control" data-oc-target="autocomplete-inquiry_id" autocomplete="off"/>
                  <input type="hidden" name="inquiry_id" value="{{ filter_enqname }}" data-oc-target="autocomplete-inquiry_id" class="form-control" autocomplete="off"/>
                  <ul id="autocomplete-inquiry_id" class="dropdown-menu"></ul>
                </div>
              </div>
              <div class="col-sm-3">
                <div class="mb-3">
                  <label class="form-label">{{ column_product }}</label>
                  <input type="text" name="filter_product" value="{{ productname }}" placeholder="{{ column_product }}" id="input-filter_product" class="form-control"  data-oc-target="autocomplete-product_id" autocomplete="off"/>

                  <input type="hidden" name="product_id" value="{{ filter_product }}" data-oc-target="autocomplete-product_id" class="form-control" autocomplete="off"/>
                    <ul id="autocomplete-product_id" class="dropdown-menu"></ul>
                </div>
              </div>
              <div class="col-sm-3">
                <div class="mb-3">
                  <label class="form-label">{{ column_seller }}</label>
                  <input type="text" name="filter_name" value="{{ sellername }}" placeholder="{{ column_seller }}"
                  id="input-vendorid" data-oc-target="autocomplete-vendorid" class="form-control" autocomplete="off"/>
                  <input type="hidden"  id="input-vendorid" name="vendor_id" value="{{ filter_name }}" data-oc-target="autocomplete-vendorid" class="form-control" autocomplete="off"/>
                  <ul id="autocomplete-vendorid" class="dropdown-menu"></ul>
                </div>

              </div>
              <div class="col-sm-3">
                <div class="mb-3">
                  <label class="form-label">{{ column_customer }}</label>
                  <input type="text" name="filter_customer" value="{{ customername }}" placeholder="{{ column_customer }}" id="input-filter_customer" data-oc-target="autocomplete-customer_id" class="form-control" autocomplete="off"/>
                  <input type="hidden" name="customer_id" value="{{ filter_customer }}" data-oc-target="autocomplete-customer_id" class="form-control" autocomplete="off"/>
                  <ul id="autocomplete-customer_id" class="dropdown-menu"></ul>
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-3 offset-sm-3">
                <button type="button" id="button-filter" class="btn btn-primary w-100"><i class="fa-solid fa-filter"></i> {{ button_filter }}</button>
              </div>
              <div class="col-sm-3">
                <a href="{{ reset }}" class="btn btn-danger w-100"><i class="fa-solid fa-refresh"></i> {{ button_reset }}</a>
              </div>
            </div>
          </div>
        </div>
        <form action="{{ delete }}" method="post" enctype="multipart/form-data" id="form-review">
          <div class="table-responsive">
            <table class="table table-bordered table-hover">
              <thead>
                <tr>
                  <td width="1" class="text-center"><input type="checkbox" onclick="$('input[name*=\'selected\']').prop('checked', this.checked);"/></td>
                  <td class="text-start">{% if sort == 'name' %}<a href="{{ sort_name }}" class="{{ order|lower }}">{{ column_name }}</a>{% else %}<a href="{{ sort_name }}">{{ column_name }}</a>{% endif %}</td>
                  <td class="text-start">{% if sort == 'email' %}<a href="{{ sort_email }}" class="{{ order|lower }}">{{ column_email }}</a>{% else %}<a href="{{ sort_email }}">{{ column_email }}</a>{% endif %}</td>
                  <td class="text-start">{% if sort == 'product' %}<a href="{{ sort_product }}" class="{{ order|lower }}">{{ column_product }}</a>{% else %}<a href="{{ sort_product }}">{{ column_product }}</a>{% endif %}</td>
                  <td class="text-start">{% if sort == 'seller' %}<a href="{{ sort_seller }}" class="{{ order|lower }}">{{ column_seller }}</a>{% else %}<a href="{{ sort_seller }}">{{ column_seller }}</a>{% endif %}</td>
                  <td class="text-start">{% if sort == 'customer' %}<a href="{{ sort_customer }}" class="{{ order|lower }}">{{ column_customer }}</a>{% else %}<a href="{{ sort_customer }}">{{ column_customer }}</a>{% endif %}</td>
                  <td class="text-start d-none">{% if sort == 'status' %}<a href="{{ sort_status }}" class="{{ order|lower }}">{{ column_status }}</a>{% else %}<a href="{{ sort_status }}">{{ column_status }}</a>{% endif %}</td>
                  <td class="text-start">{{ column_description }}</td>
                  <td class="text-start">{% if sort == 'date' %}<a href="{{ sort_date }}" class="{{ order|lower }}">{{ column_date }}</a>{% else %}<a href="{{ sort_date }}">{{ column_date }}</a>{% endif %}</td>
                  <td class="text-center">{{ column_action }}</td>
                </tr>
              </thead>
              <tbody>
                {% if inquires %}
                {% for inquiry in inquires %}
                <tr>
                  <td class="text-center"><input type="checkbox" name="selected[]" value="{{ inquiry.inquiry_id }}" {% if inquiry.inquiry_id in selected %}checked="checked"{% endif %}/></td>
                  <td class="text-start">{{ inquiry.name }}</td>
                  <td class="text-start">{{ inquiry.email }}</td>
                  <td class="text-start"><a href="{{ inquiry.producturl }}" target="_blank">{{ inquiry.pname }}</a></td>
                  <td class="text-start">{{ inquiry.sname }}</td>
                  <td class="text-start">{{ inquiry.cname }}</td>
                  <td class="text-start d-none">{{ inquiry.status }}</td>
                  <td class="text-start">{{ inquiry.description }}</td>
                  <td class="text-start"><span class="badge bg-info"><i class="fa-solid fa-clock me-1"></i> {{ inquiry.date_added }}</span></td>
                  <td class="text-center">
                    {% if inquiry.customer_id %}
                    <a href="{{ inquiry.view }}" data-bs-toggle="tooltip" target="_blank" title="{{ button_view }}" class="btn btn-primary"><i class="fa-solid fa-eye"></i></a>
                    {% else %}
                    <a href="javascript:void(0);" data-bs-toggle="tooltip" title="{{ button_view }}" class="btn btn-primary"><i class="fa-solid fa-eye"></i></a>
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
                {% else %}
                <tr>
                  <td class="text-center" colspan="9">{{ text_no_results }}</td>
                </tr>
                {% endif %}
              </tbody>
            </table>
          </div>
        </form>
        <div class="row">
          <div class="col-sm-6 text-start">{{ pagination }}</div>
          <div class="col-sm-6 text-end">{{ results }}</div>
        </div>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
$('#button-filter').on('click', function() {
    var url = 'index.php?route=extension/tmdvendorcustomercommunication/vendor/contact&user_token={{ user_token }}';
    
    var filter_customer = $('input[name=\'customer_id\']').val();

    if (filter_customer) {
        url += '&filter_customer=' + encodeURIComponent(filter_customer);
    }
    
    var filter_name = $('input[name=\'vendor_id\']').val();

    if (filter_name) {
        url += '&filter_name=' + encodeURIComponent(filter_name);
    }
    
    var filter_enqname = $('input[name=\'filter_enqname\']').val();

    if (filter_enqname) {
        url += '&filter_enqname=' + encodeURIComponent(filter_enqname);
    }
    
    var filter_product = $('input[name=\'product_id\']').val();

    if (filter_product) {
        url += '&filter_product=' + encodeURIComponent(filter_product);
    }
    
    location = url;
});
</script>

<script type="text/javascript">
$('input[name=\'filter_customer\']').autocomplete({
    'source': function(request, response) {

        $.ajax({
            {% if(VERSION2>='4.0.2.0') %}
              url: 'index.php?route=extension/tmdvendorcustomercommunication/vendor/contact.customerautocomplete&user_token={{ user_token }}&filter_customer=' + encodeURIComponent(request),
            {% else %}
              url: 'index.php?route=extension/tmdvendorcustomercommunication/vendor/contact|customerautocomplete&user_token={{ user_token }}&filter_customer=' + encodeURIComponent(request),
            {% endif %}
            dataType: 'json',
            success: function(json) {
                json.unshift({
                    customer_id: 0,
                    name: '{{ text_none }}'
                });

                response($.map(json, function(item) {
                    return {
                        label: item['name'],
                        value: item['customer_id']
                    }
                }));
            }
        });
    },
    'select': function(item) {
        $('input[name=\'filter_customer\']').val(item['label']);
        $('input[name=\'customer_id\']').val(item['value']);
    }
});
</script>

<script type="text/javascript">
$('input[name=\'filter_name\']').autocomplete({
  'source': function(request, response) {
    $.ajax({
    {% if(VERSION2>='4.0.2.0') %}
      url: 'index.php?route=extension/tmdmultivendor/vendor/vendor.autocomplete&user_token={{ user_token }}&filter_name=' +  encodeURIComponent(request),
    {% else %}
      url: 'index.php?route=extension/tmdmultivendor/vendor/vendor|autocomplete&user_token={{ user_token }}&filter_name=' +  encodeURIComponent(request),
    {% endif %}
      dataType: 'json',
      success: function(json) {
        json.unshift({
          vendor_id: 0,
          vendorname: '{{ text_none }}'
        });

        response($.map(json, function(item) {
          return {
            label: item['vendorname'],
            value: item['vendor_id']
          }
        }));
      }
    });
  },
  'select': function(item) {
    $('input[name=\'filter_name\']').val(item['label']);
    $('input[name=\'vendor_id\']').val(item['value']);
  }
});
</script>

<script type="text/javascript">
  $('input[name=\'filter_product\']').autocomplete({
    'source': function(request, response) {
      $.ajax({
        {% if(VERSION2>='4.0.2.0') %}
          url: 'index.php?route=extension/tmdmultivendor/vendor/product.autocomplete&user_token={{ user_token }}&filter_product=' + encodeURIComponent(request),
        {% else %}
          url: 'index.php?route=extension/tmdmultivendor/vendor/product|autocomplete&user_token={{ user_token }}&filter_product=' + encodeURIComponent(request),
        {% endif %}
        dataType: 'json',
        success: function(json) {
          json.unshift({
            product_id: 0,
            name: '{{ text_none }}'
          });

          response($.map(json, function(item) {
            return {
              label: item['name'],
              value: item['product_id']
            }
          }));
        }
      });
    },
    'select': function(item) {
        $('input[name=\'filter_product\']').val(item['label']);
        $('input[name=\'product_id\']').val(item['value']);
    }
  });

	$('input[name=\'filter_enqname\']').autocomplete({
    'source': function(request, response) {
      $.ajax({
      {% if(VERSION2>='4.0.2.0') %}
        url: 'index.php?route=extension/tmdvendorcustomercommunication/vendor/contact.autocomplete&user_token={{ user_token }}&filter_enqname=' +  encodeURIComponent(request),
      {% else %}
        url: 'index.php?route=extension/tmdvendorcustomercommunication/vendor/contact|autocomplete&user_token={{ user_token }}&filter_enqname=' +  encodeURIComponent(request),
      {% endif %}
        dataType: 'json',
        success: function(json) {
          response($.map(json, function(item) {
            return {
              label: item['name'],
              value: item['inquiry_id']
            }
          }));
        }
      });
    },
    'select': function(item) {
      $('input[name=\'filter_enqname\']').val(item['label']);
      $('input[name=\'inquiry_id\']').val(item['value']);
    }
	});

	$(document).bind('keypress', function(e) {
    if (e.keyCode == 13) {
      $('#button-filter').trigger('click');
    }
	});
</script>
{{ footer }}.
